---
title: "p8105_hw6_yl3181"
author: "Yuelin Long"
date: "November 20, 2018"
output: github_document
---


## Problem 1

```{r}
#Load libraries needed
library(tidyverse)
library(modelr)
```



```{r}
# Load data and tidy it
homi = read_csv("homicide-data.csv") %>% 
  mutate(city_state = str_c(city, state, sep = ", "), 
         bin_sol = (disposition == "Closed by arrest"),
         bin_race = (victim_race == "White")) %>% 
  filter (!(city_state %in% c("Dallas, TX", "Phoenix, AZ", "Kansas City, MO", "Tulsa, AL"))) %>% 
  mutate(victim_age = replace(victim_age, victim_age == "Unknown", ""),
         victim_age = as.numeric(victim_age))
```

```{r}
# Fit logistic regression and save it
sol_fit = homi %>% 
  filter(city_state == "Baltimore, MD") %>% 
  glm(bin_sol ~ victim_age + bin_race + victim_sex, data = ., family = binomial())

  
# Clean results and add estimates and CIs for ORs
sol_fit %>% 
  broom::tidy() %>% 
  

```

